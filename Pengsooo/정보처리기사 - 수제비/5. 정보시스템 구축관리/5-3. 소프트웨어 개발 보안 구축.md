## Ch.3 소프트웨어 개발 보안 구축

### (1) 소프트웨어 개발 보안 설계

#### 1. SW 개발 보안

**SW 개발 보안** 은 소스 코드 등에 존재하는 보안 취약점을 제거하고, 보안을 고려하여 기능을 설계 및 구현하는 등 소프트웨어 개발 과정에서 지켜야 할 일련의 보안 활동을 말한다.

- 구성요소 <span style="color:blue">*V*</span>

  |                          3대 요소                           | 설명                                                         |
  | :---------------------------------------------------------: | ------------------------------------------------------------ |
  | 기밀성(Confidentiality) <span style="color:blue">*V*</span> | 인가되지 않은 개인 혹은 시스템 접근에 따른 정보 공개 및 노출을 차단하는 특성 |
  |    무결성(Integrity) <span style="color:blue">*V*</span>    | 정당한 방법을 따르지 않고선 데이터가 변경될 수 없으며, 데이터의 정확성 및 완전성과 고의/악의로 변경되거나 훼손 또는 파괴디 않음을 보장하는 특성 |
  |                    가용성(Availability)                     | 권한을 가진 사용자나 애플리케이션이 원하는 서비스를 지속 사용할 수 있도록 보장하는 특성 |
  
- 용어

  |         용어          | 설명                                                         |
  | :-------------------: | ------------------------------------------------------------ |
  |     자산(Assets)      | 조직의 데이터 또는 조직의 소유자가 가치를 부여한 대상<br />Ex. 서버의 하드웨어, 기업의 중요 데이터 |
  |     위협(Threat)      | 조직이나 기업의 자산에 악영향을 끼칠 수 있는 사건이나 행위<br />Ex. 해킹, 삭제, 자산의 불법적인 유출, 위/변조, 파손 |
  | 취약점(Vulnerability) | 위협이 발생하기 위한 사전 조건을 시스템의 정보 보증을 낮추는 데 사용되는 약점<br />Ex. 평문 전손, 입력값 미검증, 비밀번호를 공유 |
  |      위험(Risk)       | 위협이 취약점을 이용하여 조직의 자산 손실 피해를 가져올 가능성 |





#### 2. Secure SDLC

**Secure SDLC(Software Development Life Cycle)** 은 개발 단계에서 발생하는 설계, 구현상의 보안 약점 극복을 위한 보안 개발 방법론이다.

- 프로세스

  | 순서 | 프로세스 | 설명                                                         |
  | :--: | :------: | ------------------------------------------------------------ |
  |  1   |   계획   | 문제점 제시 및 요구사항 파악<br />업무현황 파악, 보안 요구 계획서 작성 |
  |  2   |   분석   | 보안 요구사항을 분석하고 애플리케이션 사용자의 보안 요구사항을 정의<br />개발 프로세스와 보안 요구사항과 관계분석을 수행 |
  |  3   |   설계   | 분석 단계에서 보안 요구사항 분석서의 요구사항 반영<br />보안 구현 설계서를 작성하여 반영 |
  |  4   |   구현   | 설계 단계의 개발환경 보안 계획에 따라 환경 구성<br />보안 구현 설계서의 내용에 따라 실제 구현 시 보안 요구사항을 정의 및 활동 내역을 제시 |
  |  5   |  테스트  | 기능 명세서, 기본 설계서, 상세 설계서에 반영된 보안사항을 테스트<br />설계 단계의 보안사항을 점검 |





#### 3. 입력 데이터 검증 및 표현

**입력 데이터 검증 및 표현** 은 입력 데이터로 인해 발생하는 문제들을 예방하기 위해 구현 단계에서 검증해야 하는 보안 점검 항목들이다.

- 취약점

  |                           취약점                           | 설명                                                         | 대책                                                         |
  | :--------------------------------------------------------: | :----------------------------------------------------------- | ------------------------------------------------------------ |
  | XSS(Cross Site Script) <span style="color:blue">*V*</span> | 검증되지 않은 외부 입력 데이터가 포함된 웹페이지가 전송되는 경우, 사용자가 해당 웹페이지를 열람함으로써 웹페이지에 포함된 부적절한 스크립트가 실행되는 공격 | 특수 문자 등록을 방지하기 위해 특수 문자 필터링<br />HYML 태그 사용 금지<br />자바스크립트로 시작하는 문자열은 모두 문자열 변환처리 |
  |   사이트 간 요청 위조(CSRF; Cross\-Site Request Forgery)   | 사용자가 자신의 의지와는 무관하게 공격자가 의도한 행위를 특정 웹사이트에 요청하게하는 공격 | 입력화면 폼을 작성 시 GET 방식보다 POST 방식 사용<br />입력 폼과 입력처리 프로그램에서 세션별 CSRF 토큰을 사용하여 점검<br />중요 기능의 경우 재인증을 통해 안전하게 실제 요청 여부를 확인하도록 구현 |
  |                    SQL 삽입(Injection)                     | 응용 프로그램의 보안 취약점을 이용해서 악의적인 SQL 구문을 삽입, 실행시켜서 DB의 접근을 통해 정보를 탈취하거나 조작 등의 행위를 하는 공격기법 | 바인딩 매개변수 방식을 적용하여 사전에 변수 타입을 명시적으로 지정<br />사용자로부터 입력될 수 있는 모든 값을 체크하여 필터링<br />Servlet Filter 기능 적용(Java에서) |

  1. XSS 

     - 공격 유형

       |           공격 유형            | 설명                                                         |
       | :----------------------------: | ------------------------------------------------------------ |
       |           Stored XSS           | 방문자들이 악성 스크립트가 포함된 페이지를 읽어봄과 동시에 악성 스크립트가 브라우저에서 실행되면서 감염되는 기법 |
       |         Reflected XSS          | 공격용 악성 URL을 생성한 후 이메일로 사용자에게 전송하면 사용자가 URL 클릭 시 즉시 공격 스크립트가 피해자로 반사되어 접속 사이트에 민감정보를 공격자에게 전송하는 기법 |
       | DOM(Document Object Model) XSS | 공격자는 DOM 기반 XSS 취약점이 있는 브라우저를 대상으로 조작된 URL을 이메일을 통해 발송하고 피해자가 URL 클릭 시 공격 피해를 당하는 기법 |

     - 공격 방식

       | 번호 | 공격 절차                                                    |
       | :--: | ------------------------------------------------------------ |
       |  1   | 임의의 XSS 취약점이 존재하는 서버에 XSS 코드를 작성하여 삽입 저장 |
       |  2   | 해당 웹 서비스 사용자가 공격자가 작성해 놓은 XSS 코드에 접근 |
       |  3   | 사용자가 XSS 코드가 저장된 페이지에 정보를 요청              |
       |  4   | 사용자의 시스템에서 XSS 코드 실행                            |
       |  5   | XSS 코드가 실행된 결과가 공격자에게 전달되고 공격자는 결과를 가지고 웹 서버에서 2차 해킹 시도 |

  2. SQL 삽입

     - 공격 유형

       |           공격 유형            | 설명                                                         |
       | :----------------------------: | ------------------------------------------------------------ |
       |       Form SQL Injection       | HTML Form 기반 인증을 담당하는 애플리케이션의 취약점이 있는 경우, 사용자가 인증을 위한 쿼리 문의 조건을 임의로 조작하여 인증을 우회하는 기법 |
       |      Union SQL Injection       | union select 쿼리를 이용하여 한 쿼리의 결고라륻 라느 쿼리의 결과에 결합하여 공격하는 기법 |
       | Stored Procedure SQL Injection | 저장 프로시저(Stored Procedure)를 이용하여 공격하는 기법     |
       |       Mass SQL Injection       | 기존 SQL Injection의 확장된 개념<br />한 번의 공격으로 대량의 DB 값이 변조되어 홈페이지에 치명적인 영향을 미치는 공격기법 |
       |   Error\-Based SQL Injection   | DB 쿼리에 대한 에러값을 기반으로 한 단계씩 점진적으로 DB 정보를 획득할 수 있는 공격기법 |
       |      Blind SQL Injection       | DB 쿼리에 대한 오류 메시지를 반환하지 않으면 공격을 할 수 없는 Error\-Based SQL Injection과 달리 쿼리 결과의 참과 거짓을 통해 의도하지 않은 SQL 문을 실행함으로써 데이터베이스를 비정상적으로 공격하는 기법 |

     - 공격 방식

       | 순서 | 공격 절차                                 |
       | :--: | ----------------------------------------- |
       |  1   | 응용 프로그램의 취약점 탐지               |
       |  2   | 악의적인 SQL 구문을 삽입하여 인증 우회    |
       |  3   | 한이 상승되어 DB의 정보 탈취 및 조작 실행 |

  3. CSRF

     - 공격 방식

       | 순서 | 공격 절차                                                 |
       | :--: | --------------------------------------------------------- |
       |  1   | 공격자는 CSRF 스크립트가 포함된 게시물을 등록             |
       |  2   | 사용자는 CSRF 스크립트가 포함된 페이지의 게시물 열람 요청 |
       |  3   | 게시물을 읽은 사용자의 권한으로 공격자가 원하는 요청 발생 |
       |  4   | 공격자가 원하는 CSRF 스크립트 결과 발생                   |





#### 4. 보안 기능

**보안 기능** 은 소프트웨어 개발 단계에서 인증, 접근제어, 기밀성, 암호화, 권한 관리 등을 적절하게 구현하기 위한 보안 점검 항목들이다.

- 보안 기능 취약점

  |                          취약점                           | 설명                                                         | 대책                                                         |
  | :-------------------------------------------------------: | :----------------------------------------------------------- | ------------------------------------------------------------ |
  |              적절한 인증 없이 중요 기능 허용              | 보안 검사를 우회하여 인증과정 없이 중요 정보 또는 기능에 접근 및 변경이 가능 | 중요 정보나 기능을 수행하는 페이지에서는 재인증 기능을 통해 방지 |
  |                       부적절한 인가                       | 접근제어 기능이 없는 실행경로를 통해 정보 또는 권한 탈취     | 모든 실행경로에 대해 접근제어 검사를 수행하고, 사용자에게는 반드시 필요한 접근권만 부여하여 방지 |
  |                취약한 암호화 알고리즘 사용                | 암호화된 환경설정 파일을 해독하여 비밀번호 등의 중요정보 탈취 | 안전한 암호화 알고리즘, 안정성이 인증된 암호 모듈을 이용하여 방지 |
  |                중요 정보 평문 저장 및 전송                | 암호화되지 않은 평문 데이터를 탈취하여 중요 정보 획득 가능   | 중요한 정보 저장 및 전송 시 반드시 암호화 과정을 거치도록 하고, HTTPS, SSL/TLS 등의 보안채널을 이용하여 방지 |
  | 하드 코드 된 비밀번호 <span style="color:blue">*V*</span> | 프로그램 코드 내부에 패스워드 포함 시 관리자 정보가 노출될 수 있는 보안 취약점 | 패스워드는 암호화하여 별도 파일에 저장<br />소프트웨어 설치 시 직접 패스워드나 키를 입력하도록 설계하여 방지 |





#### 5. 에러 처리

**에러 처리** 는 프로그램 실행 시 발생하는 에러를 예외 처리하지 못하거나, 에러 정보에 중요한 정보가 포함될 때 발생할 수 있는 취약점을 예방하기 위한 보안 점검 항목들이다.

- 에러 처리 취약점

  |           취약점           | 설명                                                         | 대책                                                         |
  | :------------------------: | ------------------------------------------------------------ | ------------------------------------------------------------ |
  | 취약한 패스워드 요구 조건  | 취약한 사용자 패스워드 조합 규칙에 따른 사용자 계정 보안 취약점 | 패스워드 생성 시 강한 조건 검증 필요                         |
  | 오류 메시지 통한 정보 노출 | 프로그램이 실행환경, 사용자 , 관련 데이터에 대한 민감한 정보를 포함하는 오류 메시지를 생성하여 공격자의 악성 행위를 도와주는 보안 취약점 | 에러 메시지는 정해진 사용자에게 유용한 최소한의 정보만 표현<br />예외 사항을 내부적으로 처리하고 사용자에게 민감한 정보를 포함하는 오류 출력금지 |
  |    오류 상황 대응 부재     | 오류가 발생할 수 있는 부분을 확인하였으나, 이러한 오류에 대하여 예외 처리를 하지 않았거나 미비로 인해 발생하는 보안 약점 | 오류가 발생할 수 있는 부분에 예외 처리 구문을 작성하고, 제어문을 활용하여 오류를 악용하지 않도록 코딩 |
  |  적절하지 않은 예외 처리   | 프로그램 수행 중에 함수의 결과값에 대한 적절한 처리 또는 예외사항에 대한 조건을 적절하게 검사하지 않을 경우, 예기치 않은 문제를 일으킬 수 있는 보안 약점 | 값을 반환하는 모든 함수의 결과값을 검사하여, 그 값이 기대한 값인지 검사하고, 구체적인 예외 처리를 통해 방지 |





#### 6. 세션 통제

**세션 통제(Session Control)** 는 다른 세션 간 데이터 공유 금지 등 세션을 안전하게 관리할 수 있도록 설계한다.

- 세션 통제 취약점

  |       취약점       | 설명                                                         | 대책                                                         |
  | :----------------: | ------------------------------------------------------------ | ------------------------------------------------------------ |
  | 불충분한 세션 관리 | 인증 시 일정한 규칙이 존재하는 세션 ID를 발급<br />세션 타임아웃을 길게 설정한 경우 공격자에 의해 사용자 권한이 도용 | 클래스 변수는 세션 간에 공유되는 데이터가 되므로 클래스 설계 시 세션 정보를 읽고 쓰기가 가능한 변수를 사용하지 않도록 설계 |







### (2) 소프트웨어 개발 보안 구현

#### 1. 암호 알고리즘

**암호 알고리즘(Encryption Algorithm)** 은 데이터의 무결성 및 기밀성 확보를 위해 정보를 쉽게 해독할 수 없는 형태로 반환하는 기법이다.

- 양방향 방식

  1. 대칭 키 암호 방식

     - **대칭 키 암호 방식** 은 암호화와 복호화에 같은 암호 키를 쓰는 알고리즘이다.

     - 종류

       |       방식       | 설명                                                         |
       | :--------------: | ------------------------------------------------------------ |
       |  블록 암호 방식  | 긴 평문을 암호화하기 위해 고정 길이의 블록을 암호화하는 블록 암호 알고리즘을 반복하는 방법<br />Ex. DES, AES, SEED |
       | 스트림 암호 방식 | 매우 긴 주기의 난수열을 발생시켜 평문과 더불어 암호문을 생성하는 방식<br />Ex. RC4 |

  2. 비대칭 키 암호 방식 (=공개키 암호 방식) <span style="color:blue">*V*</span>

     - **비대칭 키 암호 방식** 은 사전에 개인 키를 나눠 가지지 않은 사용자들이 안전하게 통신하는 방식이다.
     - 공개키로 암호화된 메시지는 반드시 비밀키로 복호화해야 함. <span style="color:blue">*V*</span>
     - 공개키는 누구나 알 수 있지만, 비밀키는 키의 소유자만이 알 수 있어야 함.
     - 공개키 암호 방식: RSA, ECC, Elgamal, 디피\-헬만(Diffie\-Helllman) 등
  
  - 대칭/비대칭 키 암호 방식 비교
  
    |     구분      | 대칭 키 암호 방식                         | 비대칭 키 암호 방식                                        |
    | :-----------: | ----------------------------------------- | ---------------------------------------------------------- |
    |      키       | 대칭 키(비밀키)                           | 비대칭 키(공개키, 비밀키)                                  |
    |   키의 관계   | 암호화 키 = 복호화 키                     | 암호화 키 ≠ 복호화 키                                      |
    | 암호 알고리즘 | 공개                                      | 공개                                                       |
    |     장점      | 계산 속도가 빠름                          | 암호화 키 사전 공유 불필요<br />관리해야 할 키 개수가 적음 |
    |     단점      | 키 분배 및 관리 어려움<br />기밀성만 보장 | 계산 속도 느림                                             |
    |   알고리즘    | DES, AES, SEED                            | 디피\-헬만, RSA                                            |
  
  
  
- 일방향 암호 방식

  **일방향 암호 방식** 은 임의 길이의 정보를 입력받아, 고정된 길이의 암호문(해시값)을 출력하는 암호 방식이다.

  - 해시 암호화 알고리즘이 적용된 정보는 복호화 불가능.

  - 종류

    | 종류 | 설명                                                         |
    | :--: | ------------------------------------------------------------ |
    | MAC  | MAC은 키를 사용하는 메시지 인증 코드로 메시지의 무결성과 송신자의 인증 보장<br />Ex. HMAC, NMAC |
    | MDC  | MDC는 키를 사용하지 않는 변경 감지 코드로 메시지의 무결성 보장<br />Ex. MD5, SHA |



- 암호 알고리즘 상세 <span style="color:blue">*V*</span>

  1. 대칭 키 암호화 알고리즘 <span style="color:blue">*V*</span>

     |                     종류                      | 설명                                                         |
     | :-------------------------------------------: | ------------------------------------------------------------ |
     |         DES(Data Encryption Standard)         | 미국의 연방 표준국(NIST)에서 발표한 대칭 키 기반의 블록 암호화 알고리즘<br />블록 크기는 64bit, 키 길이는 56bit인 페이스텔(Feistel) 구조<br />3DES(Triple DES): DES를 3번 적용하여 보안을 더욱 강화 |
     |                     SEED                      | 국내 한국인터넷진흥원(KISA)이 개발한 블록 암호화 알고리즘<br />128비트 비밀키로부터 생성된 16개의 64비트 라운드 키를 사용하여 총 16회의 라운드를 걸쳐 128비트의 평문 블록을 128비트 암호문 블록으로 암호화하여 출력하는 방식<br />블록 크기는 128비트, 키 길이에 따라 128, 256비트로 분류 |
     |       AES(Advanced Encryption Standard)       | 미국 표준 기술 연구소(NIST)에서 발표한 블록 암호화 알고리즘<br />DES의 개인 키에 대한 전사적 공격이 가능해지고, 3DES의 성능문제를 극복하기 위해 개발<br />블록 크기는 128비트, 키 길이에 따라 128, 192, 256 비트로 분류<br />AES의 라운드 수는 10, 12, 14라운드로 분류<br />한 라운드는 SubBytes, ShiftRows, MixColumns, AddRoundKey 의 4가지 계층으로 구성 |
     |    ARIA(Academy Research Institute Agency)    | 국가정보원과 산학연구협회가 개발한 블록 암호화 알고리즘<br />블록 크기는 128비트, 키 길이에 따라 128, 192, 256 비트로 분류<br />경량 환경 및 하드웨어에서의 효율성 향상을 위해 개발<br />대부분의 연산은 XOR과 같은 단순한 바이트 단위 연산으로 구성된 것만 사용 |
     | IDEA(International Data Encryption Algorithm) | DES를 대체하기 위해 스위스 연방기술 기관에서 개발한 블록 암호화 알고리즘<br />128비트의 키 사용, 64비트의 평문을 8라운드에 걸쳐 64비트의 암호문 만듦 |
     |     LFSR(Linear Feedback Shift Register)      | 레지스터에 입력되는 값이 이전 상태 값들의 선형 함수로 계산되는 구조로 되어있는 스트림 암호화 알고리즘<br />주로 배타적 논리합 선형 함수를 사용<br />시드(Seed): LFSR의 초기 비트 값 |

     

  2. 비대칭 키 암호화 알고리즘

     |                             종류                             | 설명                                                         |
     | :----------------------------------------------------------: | ------------------------------------------------------------ |
     |                 디피\-헬만(Diffie\-Helllman)                 | 최초의 공개키 알고리즘<br />유한 필드 내에서 이산대수의 계산이 어려운 문제를 원리로 하고 있음<br />공개키 암호 방식의 개념을 이용하여 두 사용자 간에 공통의 암호화 키를 안전하게 공유할 방법 제시<br />많은 키 분배 방식에 관한 연구의 기본이 됨 |
     | RSA(Rivest\-Shamir\-Adleman) <span style="color:blue">*VV*</span> | 큰 인수의 곱을 소인수 분해하는 수학적 알고리즘을 이용하는 공개키 암호화 알고리즘<br />비밀키의 복호화가 어려운 RSA 안전성은 소인수 분해 문제의 어려움에 근거를 두고 있음 |
     |               ECC(Elliptic Curve Cryptography)               | RSA 암호 방식에 대한 대안으로 제안<br />타원 곡선 암호(ECC)는 유한체 위에서 정의된 타원곡선 군에서의 이산대수의 문제에 기초한 공개키 암호화 알고리즘<br />PKI 기반의 RSA의 문제점인 속도와 안전성을 해결하기 위해 타원 기반 구조체의 안전성과 효율성을 기반으로 생성<br />RSA보다 키의 비트 수를 적게 하면서 동일한 성능 제공 |
     |                           ElGamal                            | 이산대수의 계산이 어려운 문제를 기본 원리로 하고 있으며, RSA와 유사하게 전자서명과 데이터 암/복호화에 사용 가능 |

     

  3. 해시(Hash) 암호화 알고리즘

     |                  종류                   | 설명                                                         |
     | :-------------------------------------: | ------------------------------------------------------------ |
     |    MD5(Message\-Digest algorithm 5)     | MD4를 개선한 암호화 알고리즘으로 프로그램이나 파일의 무결성 검사에 사용<br />각각의 512비트짜리 입력 메시지 블록에 대해 차례로 동작하여 128비트의 해시값을 생성하는 해시 알고리즘 |
     |      SHA\-1(Secure Hash Algorithm)      | NSA에서 미 정부 표준으로 지정되었고, DSA에서 사용<br />160비트의 해시값을 생성하는 해시 알고리즘 |
     | SHA\-256/384/512(Secure Hash Algorithm) | 256비트의 해시값을 생성하는 해시 함수<br />AES의 키 길이인 128, 192, 256 비트에 대응하도록 출력 길이를 늘인 해시 알고리즘 |
     |                HAS\-160                 | 국내 표준 서명 알고리즘 KCDSA를 위하여 개발된 해시 함수<br />MD5와 SHA\-1의 장점을 취하여 개발된 해시 알고리즘 |





#### 2. 코드 오류

**코드 오류** 는 소프트웨어 구현 단계에서 프로그램 변환 시 오류, 서버의 리소스 자원의 부적절한 반환 등 개발자가 흔하게 실수하는 프로그램 오류를 예방하기 위한 보안 점검 항목들이다.

- 코드 오류 취약점

  |          취약점           | 설명                                                         | 대책                                                         |
  | :-----------------------: | ------------------------------------------------------------ | ------------------------------------------------------------ |
  |     널 포인터 역참조      | '일반적으로 그 객체가 Null이 될 수 없다'라고 하는 가정을 위반했을때 발생<br />대부분 운영체제에서 널 포인터는 메모리의 첫 주소를 가리킴, 해당 주소를 참조할 경우 소프트웨어가 비정상적으로 종료 | Null이 될 수 있는 레퍼런스는 참조하기 전에 Null 값인지를 검사하여 안전한 경우에만 사용 |
  |    정수를 문자로 변환     | 정수를 문자로 변환하면서 표현할 수 없는 범위의 값이 잘려나가 문자에 대한 저장 값이 올바르지 않은 보안 취약점 | 정수를 문자로 변환할 경우, 변환값의 크기가 변환 값이 저장되는 변수의 크기보다 크지 않도록 함 |
  |    부적절한 자원 해제     | 힙 메모리, 소켓 등 프로그램 자원 사용 후, 프로그램 오류로 인해 종료된 자원을 반환하지 못했을 때 발생할 수 있는 보안 취약점 | 자원을 획득하여 사용한 다음에는 Finally 블록에서 반드시 자원이 반환되도록 코딩함으로써 방지 |
  | 초기화되지 않은 변수 사용 | 초기화되지 않은 변수 사용은 변수 선언 후 값이 부여되지 않은 변수를 사용할 때 발생할 수 있는 보안 취약점<br />변수가 선언되어 메모리가 할당되면 해당 메모리에 이전에 사용하던 내용이 계속 남아있어 변수가 외부에 노출되는 경우에 의해 중요 정보가 악용될 수 있음 | 변수 선언 시 할당된 메모리를 초기화함으로써 방지             |





#### 3. 캡슐화

**캡슐화** 는 외부에 은닉이 필요한 중요한 데이터와 필요한 기능성을 불충분하게 캡슐화했을 때 인가되지 않은 사용자에게 데이터 유출, 권한 문제 등이 발생할 수 있는 보안 취약점 예방을 위한 보안 검증 항목들이다.

- 캡슐화 취약점

  |                취약점                 | 설명                                                         | 대책                                                         |
  | :-----------------------------------: | ------------------------------------------------------------ | ------------------------------------------------------------ |
  |  잘못된 세션에 의한 데이터 정보 노출  | 다중 스레드 환경에서 싱글톤 객체 필드에서 경쟁 조건으로 인해 동기화 오류가 발생하거나, 멤버 변수의 정보가 노출되는 보안 취약점 | 싱글톤 패턴을 사용하는 경우, 변수 범위에 주의하고, 멤버 변수보다 지역 변수를 활용하여 변수의 범위를 제안함으로써 방지 |
  |    제거되지 않고 남은 디버그 코드     | 디버깅 목적으로 삽입된 코드가 제거되지 않음으로 인해 공격자에게 의도하지 않은 정보와 제어 정보가 누출될 수 있는 보안 취약점 | 디버거 코드는 개발 완료 후, 삭제 처리                        |
  | 민감한 데이터를 가진 내부 클래스 사용 | 권한이 없는 클래스를 사용하고자 할 때 발생하는 취약점        | 내부 클래스 사용 시 외부 클래스의 접근 금지                  |
  |        시스템 데이터 정보 노출        | 시스템/관리자 DB 정보 등 시스템의 내부 데이터를 시스템 메시지 등을 통해 외부로 출력하도록 코딩했을 때 발생하는 보안 취약점 | 시스템 메시지를 통해 노출되는 메시지는 최소한의 정보만 제공함으로써 방지 |







#### 4. API 오용

**API 오용** 은 서비스에서 제공되는 이용에 반하는 방법으로 API를 이용하거나 보안에 취약한 API를 오용하여 발생할 수 있는 보안 취약점 예방을 위한 보안 검증 항목들이다.

|            취약점             | 설명                                                         | 대책                                                         |
| :---------------------------: | ------------------------------------------------------------ | ------------------------------------------------------------ |
| DNS Lookup에 의존한 보안 결정 | 도메인명에 의존하여 인증이나 접근통제 등의 보안 결정을 내리는 경우 발생하는 보안 약점<br />DNS 엔트리를 속여 동일한 도메인에 속한 서버인 것처럼 위장하거나, 사용자와 서버 간의 네트워크 트래픽을 유도하여 악성 사이트를 경유하도록 조작할 수 있음 | 보안 결정에서 도메인명을 이용한 DNS Lookup을 하지 않도록 함<br />DNS 이름 검색 함수를 사용한 후 조건문에서 인증 여부를 수행하는 것보다 IP 주소를 이용하는 것이 DNS 이름을 직접 사용하는 것보다 안전 |
|  위험하다고 알려진 함수 사용  | 보안 취약점을 고려하지 않고 개발되어, 사용자체가 취약한 함수들의 보안 취약점 | 안전한 함수 사용                                             |
|      널 매개변수 미검사       | Java 표준에서 특정 메소드 사용 시 매개변수가 널인 경우 지정된 값을 반환하지 못해 발생하는 예기치 못한 동작에 대한 보안 취약점 | 널 여부를 점검하는 과정을 거친 후 사용해야 함                |